### Python脚本
```python
def execCmd(cmd):
    print("command %s restart at: %s" % (cmd, datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S') ))
    res = os.popen(cmd).readlines()

if __name__ == '__main__':
    url = 'http://localhost:8884/api/remote/searchCoursesBySchemeId/123456'
    cmd = './root/yjsy_py/yjsy/yjsy/back-end.sh'
    with closing(Pool(processes=1)) as pool:
        while True:
            try:
                r = requests.get(url)
                # py down
                if r.status_code == 200 and r.text == "error":
                    pool.apply_async(execCmd, (cmd,))
            except:
                # external down
                pool.apply_async(execCmd, (cmd,))
            time.sleep(300)
    pool.terminate()
```

### external模块
- 使用了HttpClients ： [HttpClients使用参考](https://blog.csdn.net/renxingzhadan/article/details/118947184), [获取bear token](https://blog.csdn.net/qaz5209103/article/details/114368422), [授权认证](https://juejin.cn/post/6844904131560210440)
- 登录
- 选择角色
- 执行execute方法，catch401 error，如果401了再次执行connect方法

**更新token**
- 定期更新全局变量的token
- 设置请求头放进token【connect方法使用了synchronized】

**读取配置文件**

新建configs.properties文件

```
zhbin.config.web-configs.name=Java旅途
```

```java
@Configuration
@PropertySource(value = {"classpath:config.properties"},encoding="gbk")
public class GetProperties {

    @Value("${zhbin.config.web-configs.name}")
    private String name;
}
```

external模块存在的意义：一个是微服务，拆分到其他模块里；另一个是无需登录操作，直接get就可以了，可以实现python脚本的宕机检测功能；

external模块的其他功能：

同步系统调用的更新教师信息到idc的接口，把职工表的数据刷新到职工同步表：
- 遍历职工表的所有数据，如果同步表没有就新增
- 同步表有就更新每个字段


### 命令行启动springboot
mvn spring-boot:run

mvn install
java -jar xxxx.jar